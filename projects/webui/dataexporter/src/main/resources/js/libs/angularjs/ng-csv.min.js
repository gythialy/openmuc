!function(e,i){angular.module("ngCsv.config",[]).value("ngCsv.config",{debug:!0}).config(["$compileProvider",function(e){angular.isDefined(e.urlSanitizationWhitelist)?e.urlSanitizationWhitelist(/^\s*(https?|ftp|mailto|file|data):/):e.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|file|data):/)}]),angular.module("ngCsv.directives",["ngCsv.services"]),angular.module("ngCsv.services",[]),angular.module("ngCsv",["ngCsv.config","ngCsv.services","ngCsv.directives","ngSanitize"]),angular.module("ngCsv.services").service("CSV",["$q",function(e){var i="\r\n";this.stringifyField=function(e,i){return"locale"===i.decimalSep&&this.isFloat(e)?e.toLocaleString():"."!==i.decimalSep&&this.isFloat(e)?e.toString().replace(".",i.decimalSep):"string"==typeof e?(e=e.replace(/"/g,'""'),(i.quoteStrings||e.indexOf(",")>-1||e.indexOf("\n")>-1||e.indexOf("\r")>-1)&&(e=i.txtDelim+e+i.txtDelim),e):"boolean"==typeof e?e?"TRUE":"FALSE":e},this.isFloat=function(e){return+e===e&&(!isFinite(e)||Boolean(e%1))},this.stringify=function(a,n){var t=e.defer(),r=this,l="",o="",s=e.when(a).then(function(e){var a,s;(e=angular.copy(e),angular.isDefined(n.header)&&n.header)&&(a=[],angular.forEach(n.header,function(e,i){this.push(r.stringifyField(e,n))},a),s=a.join(n.fieldSep?n.fieldSep:","),o+=s+i);var d=[];angular.isArray(e)?d=e:angular.isFunction(e)&&(d=e()),angular.forEach(d,function(e,a){var t,l;l=[],angular.forEach(e,function(e,i){this.push(r.stringifyField(e,n))},l),t=l.join(n.fieldSep?n.fieldSep:","),o+=a<d.length?t+i:t}),n.addByteOrderMarker&&(l+="\ufeff"),l+=o,t.resolve(l)});return"function"==typeof s.catch&&s.catch(function(e){t.reject(e)}),t.promise}}]),angular.module("ngCsv.directives").directive("ngCsv",["$parse","$q","CSV","$document","$timeout",function(i,a,n,t,r){return{restrict:"AC",scope:{data:"&ngCsv",filename:"@filename",header:"&csvHeader",txtDelim:"@textDelimiter",decimalSep:"@decimalSeparator",quoteStrings:"@quoteStrings",fieldSep:"@fieldSeparator",lazyLoad:"@lazyLoad",addByteOrderMarker:"@addBom",ngClick:"&",charset:"@charset"},controller:["$scope","$element","$attrs","$transclude",function(e,i,t,r){e.csv="",angular.isDefined(e.lazyLoad)&&"true"==e.lazyLoad||angular.isArray(e.data)&&e.$watch("data",function(i){e.buildCSV()},!0),e.getFilename=function(){return e.filename||"download.csv"},e.buildCSV=function(){var r,l=a.defer();return i.addClass(t.ngCsvLoadingClass||"ng-csv-loading"),n.stringify(e.data(),(r={txtDelim:e.txtDelim?e.txtDelim:'"',decimalSep:e.decimalSep?e.decimalSep:".",quoteStrings:e.quoteStrings,addByteOrderMarker:e.addByteOrderMarker},angular.isDefined(t.csvHeader)&&(r.header=e.$eval(e.header)),r.fieldSep=e.fieldSep?e.fieldSep:",",r)).then(function(a){e.csv=a,i.removeClass(t.ngCsvLoadingClass||"ng-csv-loading"),l.resolve(a)}),e.$apply(),l.promise}}],link:function(i,a,n){a.bind("click",function(a){i.buildCSV().then(function(a){!function(){var a=i.charset||"utf-8",n=new Blob([i.csv],{type:"text/csv;charset="+a+";"});if(e.navigator.msSaveOrOpenBlob)navigator.msSaveBlob(n,i.getFilename());else{var l=angular.element("<a></a>");l.attr("href",e.URL.createObjectURL(n)),l.attr("download",i.getFilename()),l.attr("target","_blank"),t.find("body").append(l),r(function(){l[0].click(),l.remove()},null)}}()}),i.$apply()})}}}])}(window,document);